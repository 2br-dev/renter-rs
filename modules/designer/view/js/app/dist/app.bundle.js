!function(e){function t(t){for(var s,n,a=t[0],r=t[1],c=t[2],d=0,u=[];d<a.length;d++)n=a[d],Object.prototype.hasOwnProperty.call(l,n)&&l[n]&&u.push(l[n][0]),l[n]=0;for(s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s]);for(h&&h(t);u.length;)u.shift()();return i.push.apply(i,c||[]),o()}function o(){for(var e,t=0;t<i.length;t++){for(var o=i[t],s=!0,n=1;n<o.length;n++){var r=o[n];0!==l[r]&&(s=!1)}s&&(i.splice(t--,1),e=a(a.s=o[0]))}return e}var s={},l={2:0},i=[];function n(e){return a.p+""+({0:"default~controlColor~~3adb26a7",1:"default~controlFile~u~69c9712b",3:"atomAttrsTab",4:"atomButton",5:"atomCSSTab",6:"atomColumn",7:"atomControlAdditionalClass",8:"atomControlCollection",9:"atomControlHiddenOnMobileToggle",10:"atomControlHiddenSize",11:"atomControlResetButton",12:"atomDList",13:"atomEmptyLine",14:"atomForm",15:"atomGallery",16:"atomHTML",17:"atomHeader",18:"atomHr",19:"atomImage",20:"atomMMenu",21:"atomMarginZone",22:"atomMenu",23:"atomProduct",24:"atomProductList",25:"atomRowMarginZone",26:"atomRowPaddingZone",27:"atomSlider",28:"atomSocial",29:"atomText",30:"atomVideo",31:"atomYandexMap",32:"controlAlignItems",33:"controlAttrSelect",34:"controlAttrSize",35:"controlCheckbox",36:"controlColor",37:"controlDList",38:"controlDirectLink",39:"controlFile",40:"controlFlexAlignItems",41:"controlImage",42:"controlInput",43:"controlLink",44:"controlMapPoints",45:"controlORMFields",46:"controlRadio",47:"controlResetRootData",48:"controlSelect",49:"controlSelectColumnClass",50:"controlSelectFieldValueAsTree",51:"controlSelectFieldValueFromJSONData",52:"controlSelectFieldsForMenu",53:"controlSize",54:"controlSizeForOutline",55:"controlSizeFourDigits",56:"controlSizeFourDigitsForBorder",57:"controlSizeShadow",58:"controlTextArea",59:"controlToggleButton",60:"controlToggleCheckbox",61:"controlToggleMenuButton",62:"controlVAlignItems",63:"panelAtom",64:"panelColumn",65:"panelInstruments",66:"panelPresets",67:"panelRow",68:"tinyMCEEditor",69:"uploadImageFiles",70:"uploadPixabayUpload",71:"uploadSVGImageUpload",72:"uploadSimpleImageUpload",74:"widthResize"}[e]||e)+".bundle.js"}function a(t){if(s[t])return s[t].exports;var o=s[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,a),o.l=!0,o.exports}a.e=function(e){var t=[],o=l[e];if(0!==o)if(o)t.push(o[2]);else{var s=new Promise((function(t,s){o=l[e]=[t,s]}));t.push(o[2]=s);var i,r=document.createElement("script");r.charset="utf-8",r.timeout=30,a.nc&&r.setAttribute("nonce",a.nc),r.src=n(e);var c=new Error;i=function(t){r.onerror=r.onload=null,clearTimeout(d);var o=l[e];if(0!==o){if(o){var s=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+s+": "+i+")",c.name="ChunkLoadError",c.type=s,c.request=i,o[1](c)}l[e]=void 0}};var d=setTimeout((function(){i({type:"timeout",target:r})}),3e4);r.onerror=r.onload=i,document.head.appendChild(r)}var h={8:[0,36,54,56,57,1,39,32,33,34,35,37,38,40,41,42,43,44,45,46,47,48,49,50,51,52,53,55,58,59,60,61,62],19:[1,72,69,70,71],37:[1,72,69,70,71],41:[1,72,69,70,71]}[e];return h&&h.forEach((function(e){if(void 0===l[e]){l[e]=null;var t=document.createElement("link");t.charset="utf-8",a.nc&&t.setAttribute("nonce",a.nc),t.rel="preload",t.as="script",t.href=n(e),document.head.appendChild(t)}})),Promise.all(t)},a.m=e,a.c=s,a.d=function(e,t,o){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(a.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)a.d(o,s,function(t){return e[t]}.bind(null,s));return o},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/modules/designer/view/js/app/dist/",a.oe=function(e){throw console.error(e),e};var r=window.webpackJsonp=window.webpackJsonp||[],c=r.push.bind(r);r.push=t,r=r.slice();for(var d=0;d<r.length;d++)t(r[d]);var h=c;i.push([157,73]),o()}({1:function(e,t,o){"use strict";o.d(t,"a",(function(){return i})),o.d(t,"b",(function(){return n}));var s=o(56),l=o.n(s);const i={row:"row",column:"column",atoms:"atoms",atom:"atom"};class n{static fillDataBlockByStructure(e,t){return Object.keys(t).forEach(o=>{("object"!=typeof e||e.hasOwnProperty(o))&&(e[o]||0===e[o]||""===e[o])?"object"==typeof e[o]&&(e[o]=n.fillDataBlockByStructure(e[o],t[o])):e[o]=t[o]}),e}static getMouseOrTouchMoveCoordinate(e,t){return e.targetTouches?e.targetTouches[0]["y"==t.toLowerCase()?"clientY":"clientX"]:e["y"==t.toLowerCase()?"clientY":"clientX"]}static prepareBlocksData(e){switch(Array.isArray(e)&&e.forEach((t,o)=>{e[o]=n.prepareBlocksData(t)}),e.childs&&(Array.isArray(e.childs)?e.childs.forEach((t,o)=>{e.childs[o]=n.prepareBlocksData(t)}):Object.keys(e.childs).length&&Object.keys(e.childs).forEach(t=>{e.childs[t]=n.prepareBlocksData(e.childs[t])})),e.type){case i.row:e=n.fillDataBlockByStructure(e,n.getStructureByType(i.row));break;case i.column:e=n.fillDataBlockByStructure(e,n.getStructureByType(i.column));break;case i.atom:e=n.fillDataBlockByStructure(e,n.getStructureByType(i.atoms,e.atomType))}return e}static getStructureByType(e,t=null){let o=window.global.designer.structures;if("atom"==e){if(!t)throw new Error(lang.t("Не указан под тип для атома с типом %0 при получении структуры %1",[e,t]));if(!o[e][t])throw new Error(lang.t("Не найдена структура для атом с типом %0 при получении структуры %1",[e,t]))}let s="atoms"!=e?o[e]:o[e][t];return JSON.parse(JSON.stringify(s))}static getStructuresForAtoms(){let e=window.global.designer.structures.atoms,t=[];return Object.keys(e).forEach(o=>t.push(e[o])),t}static convertInlineStyleToObject(e){let t=e.split(";"),o={};return t.length&&t.forEach(e=>{let t=e.split(":");if(t.length>1){let e=t.shift().trim();o[e]=t.join(":").trim()}}),o}static workStyleValueToCSSArray(e,t,o){if("object"==typeof e){let s=[];if(e["border-type"])e.top==e.left&&e.left==e.right&&e.right==e.bottom?o.push(t+":"+e.top+" "+e["border-type"]+" "+e["border-color"]):["top","left","bottom","right"].forEach(t=>{o.push("border-"+t+":"+e[t]+" "+e["border-type"]+" "+e["border-color"])});else{let l=!0;Object.keys(e).forEach(t=>{e[t].length||(l=!1),s.push(e[t])}),l&&(s=s.join(" "),s.length&&o.push(t+":"+s))}}else e.length&&("background-image"==t&&(e="url("+e+")"),o.push(t+":"+e));return o}static isItMacOrIOS(){return/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform)}static getClickOrTouchEvent(e="click"){let t="ontouchstart"in document.documentElement&&navigator.userAgent.match(/Mobi/);switch(e){case"mousemove":case"touchmove":return t?"touchmove":"mousemove";case"mouseup":case"touchend":return t?"touchend":"mouseup";case"mousedown":return t?"touchstart":"mousedown";case"click":default:return t?"touchstart":"click"}}static isAtomCanBeDeletedByButton(){return!n.isItMacOrIOS()&&"touchstart"!=n.getClickOrTouchEvent()}static convertStyleObjectToString(e){let t=[];return Object.keys(e).forEach(o=>{let s=e[o];n.workStyleValueToCSSArray(s,o,t)}),t.join(";")}static toggleModuleButtons(e){let t=document.querySelector(".designer-block[data-id='"+e+"']");if(t&&t.classList.contains("d-empty")){t.classList.remove("d-empty"),t.closest(".module-wrapper").querySelectorAll(".d-module-button").forEach(e=>{e.classList.toggle("d-hide")})}}static closeAllPanels(){let e=new CustomEvent("designer.close-all-panels");document.dispatchEvent(e)}static getFontSizeClasses(){let e=n.range(10,70,2),t={};return e.forEach((e,o)=>{t[e]="d-fontsize-"+e+"px"}),t}static range(e,t,o){let s,l,i,n=[],a=o||1,r=!1;if(isNaN(e)||isNaN(t)?isNaN(e)&&isNaN(t)?(r=!0,s=e.charCodeAt(0),l=t.charCodeAt(0)):(s=isNaN(e)?0:e,l=isNaN(t)?0:t):(s=e,l=t),i=!(s>l),i)for(;s<=l;)n.push(r?String.fromCharCode(s):s),s+=a;else for(;s>=l;)n.push(r?String.fromCharCode(s):s),s-=a;return n}static getDesignMenuPosition(){let e=l.a.get("designMenuPosition");return!!e&&JSON.parse(e)}static setDesignMenuPosition(e){l.a.set("designMenuPosition",JSON.stringify({top:e.top,left:e.left,right:e.right,height:e.height}),30)}static makeCRCTable(){let e,t=[];for(let o=0;o<256;o++){e=o;for(let t=0;t<8;t++)e=1&e?3988292384^e>>>1:e>>>1;t[o]=e}return t}static crc32(e){var t=window.crcTable||(window.crcTable=n.makeCRCTable()),o=-1;for(let s=0;s<e.length;s++)o=o>>>8^t[255&(o^e.charCodeAt(s))];return(-1^o)>>>0}static checkProSubscribe(){return!n.checkProSubscribeBroken()&&1===window.global.designer.pro_account.type}static checkProSubscribeBroken(){let e=lang.t("Отсутствует Pro подписка");return void 0===window.global.designer.pro_account||void 0===window.global.designer.pro_account.type||void 0===window.global.designer.pro_account.pro_account_sign?(alert(e),!0):window.global.designer.pro_account.pro_account_sign!=n.crc32(window.global.designer.pro_account.type+"designer_pro_account")&&(alert(e),!0)}static getTinyMceFontSizePlagin(e){return{text:"10px",icon:"change-case",onAction:e=>{},onItemAction:(t,o)=>{let s=e.selection.getContent({format:"html"});if(-1!=s.search(/(^<(\w+))/gi)){let t=n.getFontSizeClasses();Object.keys(t).forEach(o=>{let s=t[o];e.dom.removeClass(e.selection.getNode(),s)}),e.dom.addClass(e.selection.getNode(),o)}else{let t='<span class="'+o+'">'+s+"</span>";e.insertContent(t)}e.focus()},fetch:(e,t)=>{setTimeout(()=>{document.querySelector(".tox-selected-menu").classList.add("d-tiny-selected-menu")},300);let o=n.getFontSizeClasses(),s=[];Object.keys(o).forEach(e=>{let t=o[e];s.push({type:"choiceitem",text:e+"px",value:t})}),e(s)}}}}},100:function(e,t,o){"use strict";var s=o(1);t.a={computed:{getAttrsWithoutClassAndStyle(){let e=this.getData().attrs,t={};return Object.keys(e).forEach(o=>{"style"!=o&&"class"!=o&&(t[o]=e[o])}),t},getClass(){let e=this.getData().attrs;return e&&e.class?e.class.value:""},getStyle(){let e=this.getData().attrs;return s.b.convertInlineStyleToObject(e&&e.style?e.style.value:{})}}}},101:function(e,t,o){"use strict";var s=o(7),l=o(1);const i="left",n="right";t.a={data:()=>({controlOnStart:!1}),methods:{async appendToNewColumn(e,t="right"){setTimeout(()=>{if(window.cancel_drag)window.cancel_drag=!1;else{if(e.added){let o=this.getBlockData(this.blockId),s=JSON.parse(JSON.stringify(e.added)).element,i=JSON.parse(JSON.stringify(o.childs.row.childs));if(i.length+1<13){let e,a=i[0],r=a.css["--designer-column-padding-top"].value,c=a.css["--designer-column-padding-bottom"].value,d=l.b.getStructureByType(l.a.column);r&&(d.css["--designer-column-padding-top"].value=r),c&&(d.css["--designer-column-padding-bottom"].value=c),s.id=this.uuid(),s.name=s.name.replace("{n}",s.id),d.id=this.uuid(),d.name=d.name.replace("{n}",d.id),d.childs=[],i.push(d),e=t==n?this.colIndex+1:0,this.deleteStoreCaches(),i.move(i.length-1,e),this.deleteStoreCaches(),i=this.changeColWidthAfterAppend(i),this.deleteStoreCaches(),o.childs.row.childs=i,this.setBlockData({block_id:this.blockId,childs:o.childs}).then(()=>{this.deleteStoreCaches(),this.addNewAtomToColumn({block_id:this.blockId,col_id:d.id,index:0,atom:s})})}else alert(lang.t("Превышено количество колонок для создания. Создайте новый блок."))}this.closeLastPanel()}},300)},async appendToNewColumnToLeft(e){this.appendToNewColumn(e,i)},changeColumnsWidthsAfterOneChange(e){let t=this.getColumnCount(this.blockId)-1;if(!t)return;let o,s=12-e,l=this.getBlockData(this.blockId),i=JSON.parse(JSON.stringify(l.childs.row.childs));if(s%t==0)o=s/t,i.forEach(e=>{e.id!=this.itemId&&(e.attrs.class.value=this.getColClassBySize(o))});else{o=Math.floor(s/t);let e=o+s%t;i.forEach((t,s)=>{t.id!=this.itemId&&(s!=i.length-1?t.attrs.class.value=this.getColClassBySize(o):t.attrs.class.value=this.getColClassBySize(e))})}this.deleteStoreCaches(),l.childs.row.childs=i,this.setBlockData({block_id:this.blockId,childs:l.childs}),this.deleteStoreCaches()},changeColumnsWidths(e){let t=this.getBlockData(e),o=JSON.parse(JSON.stringify(t.childs.row.childs));o.length&&(o=this.changeColWidthAfterAppend(o),this.deleteStoreCaches(),t.childs.row.childs=o,this.setBlockData({block_id:e,childs:t.childs}).then(()=>{let e=new CustomEvent("designer.change-column-width");document.dispatchEvent(e)}))},...Object(s.b)("blocks",["deleteStoreCaches","setBlockData"])},computed:{...Object(s.c)("blocks",["getBlockData"])}}},145:function(e,t,o){"use strict";o.d(t,"a",(function(){return l}));var s=o(30);class l extends s.a{getOrmFieldsData(e,t,o){let s={type:e,id:t,attr_name:o},l=this.createUrlWithParams(window.global.designer.getOrmFieldsDataUrl,s);return this.makeGETRequest(l)}saveAtomData(e,t){let o=window.global.designer.saveAtomDataUrl,s={block_id:e,data:t};return this.makePOSTRequest(o,s)}deleteAtom(e,t){let o=window.global.designer.deleteAtomUrl,s={block_id:t.block_id,id:t.id};return this.makePOSTRequest(o,s)}}},147:function(e,t,o){"use strict";var s=o(7),l=o(148),i=o.n(l),n=o(1);t.a={data:()=>({controlOnStart:!1}),components:{draggable:i()},methods:{uuid(){let e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",t="";for(let o=0,s=e.length;o<12;o++)t+=e.charAt(Math.floor(Math.random()*s));return t},dragstart(e){this.draggableIsEnabled&&(this.checkCTRLPressed(e),this.setIsDraggingNow(!0),n.b.closeAllPanels())},dragend(){this.draggableIsEnabled&&this.setIsDraggingNow(!1)},checkCTRLPressed({originalEvent:e}){this.controlOnStart=e.ctrlKey},...Object(s.b)("blocks",["setIsDraggingNow","setBlockData","addNewAtomToColumn","moveAtomInColumn"]),...Object(s.b)(["closeLastPanel"])},computed:{...Object(s.c)("blocks",["getIsDraggingNow","getBlockData"])}}},156:function(e,o,s){"use strict";s.r(o);var l=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"d-menu-content"},[e._l(e.getMenuStack,(function(t,s){return[o("div",{directives:[{name:"show",rawName:"v-show",value:s==e.getMenuStack.length-1,expression:"index == getMenuStack.length-1"}],staticClass:"d-menu-content-panel"},["instruments"==t.type?[o("PanelInstruments",{attrs:{data:t.data}})]:"presets"==t.type?[o("PanelPresets",{attrs:{data:t.data}})]:"row"==t.type?[o("PanelRow",{attrs:{data:t.data}})]:"column"==t.type?[o("PanelColumn",{attrs:{data:t.data}})]:[o("PanelAtom",{attrs:{data:t.data}})]],2)]}))],2)};l._withStripped=!0;var i=s(7),n={mixins:[{computed:{...Object(i.c)(["getMenuStack"])},updated(){document.querySelector(".d-side-menu-container").classList.add("d-in-loading"),setTimeout(()=>{document.querySelector(".d-side-menu-container").classList.remove("d-in-loading")},500)}}],components:{PanelInstruments:()=>s.e(65).then(s.bind(null,403)),PanelPresets:()=>s.e(66).then(s.bind(null,404)),PanelRow:()=>s.e(67).then(s.bind(null,405)),PanelColumn:()=>s.e(64).then(s.bind(null,406)),PanelAtom:()=>s.e(63).then(s.bind(null,389))}},a=s(98),r=Object(a.a)(n,l,[],!1,null,null,null);r.options.__file="-readyscript/modules/designer/view/js/app/src/components/leftpanel/panels/sidemenu/sidemenu.vue";var c=r.exports,d=s(1),h={data:()=>({body:null,left:0,top:0,leftMenuContainer:null,leftPillow:null,rightPillow:null,windowWidth:0}),mounted(){let e=d.b.getDesignMenuPosition();this.leftMenuContainer=document.querySelector(".design-menu"),e&&(this.leftMenuContainer.style.top=e.top,this.leftMenuContainer.style.left=e.left,this.leftMenuContainer.style.right=e.right,this.leftMenuContainer.style.position=e.position,this.leftMenuContainer.style.height=e.height)},methods:{startMoveMenu(e){this.body=document.querySelector("body"),this.body.classList.add("designer-drag-mode"),this.leftMenuContainer.style.transition="none",this.body.addEventListener(this.$mouseup,this.saveWindowLocation),this.body.addEventListener(this.$mousemove,this.windowMouseMoving),this.body.insertAdjacentHTML("beforeEnd",'<div id="d-left-menu-pillow-left" class="d-left-menu-pillow"></div><div id="d-left-menu-pillow-right" class="d-left-menu-pillow d-right"></div>'),this.windowWidth=window.innerWidth-200,this.leftPillow=document.getElementById("d-left-menu-pillow-left"),this.rightPillow=document.getElementById("d-left-menu-pillow-right")},changeAtomMenuTogglerPosition(){let e=this.windowWidth-190;this.left>=e?this.leftMenuContainer.classList.add("d-atom-menu-toggler-right"):this.leftMenuContainer.classList.remove("d-atom-menu-toggler-right")},windowMouseMoving(e){this.top=d.b.getMouseOrTouchMoveCoordinate(e,"y"),this.left=d.b.getMouseOrTouchMoveCoordinate(e,"x"),this.changeAtomMenuTogglerPosition(),this.leftMenuContainer.style.left=this.left-15+"px",this.leftMenuContainer.style.top=this.top-15+"px",this.leftMenuContainer.style.height=window.innerHeight/2+"px",this.left<200?this.leftPillow.classList.add("d-show"):this.leftPillow.classList.remove("d-show"),this.left>this.windowWidth?this.rightPillow.classList.add("d-show"):this.rightPillow.classList.remove("d-show")},saveWindowLocation(){this.body.removeEventListener(this.$mousemove,this.windowMouseMoving),this.body.removeEventListener(this.$mouseup,this.saveWindowLocation),this.leftMenuContainer.style.transition="all .3s",document.querySelectorAll(".d-left-menu-pillow").forEach(e=>{e.remove()}),this.body.classList.remove("designer-drag-mode"),this.left<200&&(this.leftMenuContainer.style.left="0px",this.leftMenuContainer.style.top="0px",this.leftMenuContainer.style.height="100%"),this.left>this.windowWidth&&(this.leftMenuContainer.style.left="inherit",this.leftMenuContainer.style.right="0px",this.leftMenuContainer.style.top="0px",this.leftMenuContainer.style.height="100%"),d.b.setDesignMenuPosition({top:this.leftMenuContainer.style.top,left:this.leftMenuContainer.style.left,right:this.leftMenuContainer.style.right,height:this.leftMenuContainer.style.height})}}},u=s(101),m=s(99),g=s(33);const p=".design-menu",f=".open-designer",w=".open-designer-row-settings",b="instruments",k="row",y="column",v="atom";var C={data:{isOpened:!1,isMenuShowed:!1},mounted:function(){this.$store.subscribe(e=>{if("closeLastPanel"==e.type){this.getMenuStack.length||this.close()}}),document.addEventListener("designer.close-all-panels",this.close,{passive:!1})},beforeDestroy(){document.removeEventListener("designer.close-all-panels",this.close)},methods:{init(){let e=document.querySelector("body");e.addEventListener(this.$clickevent,this.openInstruments,{passive:!1}),e.addEventListener(this.$clickevent,this.openSettings,{passive:!1}),e.addEventListener(this.$clickevent,this.checkDisableEditMode,{passive:!1}),e.addEventListener("designer.open-menu",e=>{this.open(e.detail.type,e.detail.category,e.detail.data)},{passive:!1})},openInstruments(e){if(e.target.closest(f))return this.open(b,lang.t("Панель инструментов"),{blockId:$(e.target).data("blockId")}),e.preventDefault(),e.stopPropagation(),!1},checkDisableEditMode(e){e.target.closest(".d-atom")||e.target.closest(".d-menu-control")||(document.querySelector("body").classList.remove("d-edit-mode"),document.querySelectorAll(".d-atom").forEach(e=>{e.classList.remove("hover")}))},openSettings(e){if(e.target.closest(w))return this.open(k,lang.t("Настройки блока"),{blockId:$(e.target).data("blockId"),type:k}),e.preventDefault(),e.stopPropagation(),!1},moveLeftMenuToDefaultPositionIfNeeded(){let e=document.querySelector(p),t=e.getBoundingClientRect().left,o=window.innerWidth;if(o<t-200){let t=0,o=0,s="100%",l="inherit";e.style.top=0,e.style.left=0,e.style.right=l,e.style.height=s,d.b.setDesignMenuPosition({top:t,left:o,right:l,height:s})}t+370>=o&&e.classList.add("d-atom-menu-toggler-right")},checkLeftMenuToClose(e){e.target.closest(".design-menu")||e.target.closest(".d-dialog-wrapper")||e.target.closest(".d-atom")||e.target.closest(".color-picker-dashboard")||e.target.closest(".d-upload-button")||(this.close(),document.removeEventListener(this.$clickevent,this.checkLeftMenuToClose))},checkDeleteAtom(e){if("Delete"==e.key&&!e.target.closest("input")&&!e.target.closest("textarea")&&!e.target.closest("[content-editable]")){let e=this.getMenuStack;if(e.length){let t=e[e.length-1];"atom"==t.type&&setTimeout(()=>{let e=t.data.id,o=t.data.blockId,s=this.getColumnIdFromAtomId(e);this.deleteAtom({block_id:o,id:e}),this.changeColumnsWidthsIfNeeded(o,s)},500),"column"==t.type&&setTimeout(()=>{this.deleteColumn({block_id:t.data.blockId,id:t.data.id}),this.changeColumnsWidths(t.data.blockId)},500)}this.close(),document.removeEventListener("keyup",this.checkDeleteAtom)}},open(e="instruments",t="",o=null){let s={type:e,title:t};o&&(s.data=o),g.a.dispatch("openMenu",s),this.isOpened=!0,document.querySelector("#d-side-menu-right-menu-opener").style.display="none",document.removeEventListener(this.$clickevent,this.checkLeftMenuToClose),document.addEventListener(this.$clickevent,this.checkLeftMenuToClose,{passive:!1}),document.removeEventListener("keyup",this.checkDeleteAtom);let l=!0;s.data.id&&"mobilemenu"==s.data.id&&(l=!1),l&&document.addEventListener("keyup",this.checkDeleteAtom),setTimeout(()=>{this.moveLeftMenuToDefaultPositionIfNeeded(),this.isMenuShowed=!0},200)},openMenuForAtom(e=null){this.open(v,lang.t("Редактирование элемента"),e)},openMenuForColumn(e=null){this.open(y,lang.t("Редактирование колонки"),e)},close(){this.isMenuShowed=!1,this.isOpened=!1;let e=document.querySelectorAll(".d-atom.hover");e.length&&e.forEach(e=>{e.classList.remove("hover")}),document.querySelector("#d-side-menu-right-menu-opener").style.display="none",setTimeout(()=>{this.isOpened||(this.clearMenuStack(),this.enableEditModeModules(),document.querySelector("body").classList.remove("d-row-edit"))},300)},enableEditModeModules(){let e=document.querySelector("body").querySelectorAll(".module-wrapper");e&&e.forEach(e=>{e.classList.remove("disabled")})},...Object(i.b)(["clearMenuStack","closeLastPanel"]),...Object(i.b)("blocks",["deleteAtom","deleteColumn"])},computed:{...Object(i.c)(["getSelectedMenuTitle","getMenuStack"]),...Object(i.c)("blocks",["getBlockData","getColumnIdFromAtomId","getColumnData"])}},S=s(6),E=s(56),M=s.n(E),D=s(146),A=s.n(D),_=s(150),O=s(152),B=s(154),T=s.n(B),I=s(155),P=s.n(I);s.d(o,"designerLeftMenu",(function(){return L})),S.default.prototype.$clickevent=d.b.getClickOrTouchEvent(),S.default.prototype.$mouseup=d.b.getClickOrTouchEvent("mouseup"),S.default.prototype.$mousemove=d.b.getClickOrTouchEvent("mousemove"),S.default.use(P.a),S.default.use(_.a),S.default.use(M.a),S.default.use(O.a),S.default.use(T.a,{dynamic:!0,dynamicDefaults:{clickToClose:!0},injectModalsContainer:!0}),S.default.mixin({methods:{lang:e=>lang.t(e)}});const L=new S.default({el:"#design-menu-app",store:g.a,template:'\n        <div class="design-menu" :class="{ \'d-open\': isOpened }">\n            <div class="design-menu-overflow">\n                <div class="d-header">\n                    <a class="d-close" @mousedown.left.passive.stop="close" @touchstart.passive.stop="close"></a>\n                    <a class="d-move-menu" @mousedown.left.passive="startMoveMenu" @touchstart.passive="startMoveMenu"></a>\n                    <div class="d-panel-title"  @mousedown.left.passive="startMoveMenu" @touchstart.passive="startMoveMenu" v-html="getSelectedMenuTitle"></div>\n                </div>\n                <div class="d-side-menu-container">\n                    <SideMenu class="d-side-menu" :class="{ \'d-show\': isMenuShowed }"></SideMenu>\n                </div>\n            </div>\n            <a id="d-side-menu-right-menu-opener" class="d-side-menu-right-menu-opener" style="display: none" :title="lang(\'Открытие меню элементов\')"></a>\n        </div>\n    ',mixins:[h,u.a,m.a,C],components:{SideMenu:c,"vue-load-image":A.a}});document.addEventListener("DOMContentLoaded",(function(){!function(){if(document.querySelector(".designer-block")){var e=0;try{var o=navigator.userAgent.match(/(MSIE |Trident.*rv[ :])([0-9]+)/);o&&(e=o[2]),e>0&&e<12&&alert(t.lang('Для работы модуля "Дизайнер", необходим более современный браузер.'))}catch(e){console.error(e)}}}(),L.init()}))},157:function(e,t,o){o(156),o(363),e.exports=o(364)},30:function(e,t,o){"use strict";o.d(t,"a",(function(){return a}));var s=o(149),l=o.n(s),i=o(51);const n=l.a.create({withCredentials:!1,timeout:29e3,headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"}});class a{showLoading(){$.rs&&$.rs.loading.show()}hideLoading(){$.rs&&$.rs.loading.hide()}makePOSTRequest(e,t){this.showLoading();const o=new URLSearchParams;return Object.keys(t).forEach(e=>{let s=t[e];"object"==typeof t[e]&&(s=JSON.stringify(t[e])),o.append(e,s)}),n.post(e,o).then(e=>{let t=e.data.messages;if(t&&t.length){i.a.clear();for(let e in t)i.a.showMessage(t[e])}return this.hideLoading(),e.data}).catch(e=>{this.hideLoading(),a.handleError(e)})}createUrlWithParams(e,t={}){e||console.error(lang.t("URL адрес не указан"));let o=[];return Object.keys(t).forEach(e=>{"object"==typeof t[e]?Object.keys(t[e]).forEach(s=>{o.push(e+"["+s+"]="+encodeURIComponent(t[e][s]))}):o.push(e+"="+encodeURIComponent(t[e]))}),o.length&&(-1!=e.indexOf("?")?e+="&"+o.join("&"):e+=o.join("&")),e}makeGETRequest(e){return e||console.error(lang.t("URL адрес не указан")),this.showLoading(),n.get(e).then(e=>{let t=e.data.messages;if(t&&t.length){i.a.clear();for(let e in t)i.a.showMessage(t[e])}return this.hideLoading(),e.data}).catch(e=>{this.hideLoading(),a.handleError(e)})}static handleError(e){console.error(e)}}},33:function(e,o,s){"use strict";var l={};s.r(l),s.d(l,"namespaced",(function(){return h})),s.d(l,"state",(function(){return u})),s.d(l,"getters",(function(){return m})),s.d(l,"mutations",(function(){return g})),s.d(l,"actions",(function(){return p}));var i=s(6),n=s(7),a=s(1),r=s(30);class c extends r.a{deletePreset(e){let t=window.global.designer_admin.deletePresetUrl;return t=t+"&preset_id="+e,this.makeGETRequest(t)}getPreset(e){let t=window.global.designer.getPresetUrl;return t=t+"&preset_id="+e,this.makeGETRequest(t)}}const d=new c,h=!0;console.log("Helpers.getStructuresForAtoms()",a.b.getStructuresForAtoms());const u={presetCategories:window.global.designer.presets.categories,presets:window.global.designer.presets.list},m={getPresetCategories:e=>e.presetCategories,getPresets:e=>e.presets,getPresetByCategory:e=>t=>e.presets[t]?e.presets[t]:[]},g={deletePreset(e,t){Object.keys(e.presets).forEach(o=>{e.presets[o].forEach((s,l)=>{s.alias==t&&e.presets[o].splice(l,1)})})}},p={deletePreset({commit:e,state:t,getters:o},s){e("deletePreset",s),d.deletePreset(s)}};s(176);class f extends r.a{saveColumnData(e,t){let o=window.global.designer.saveColumnDataUrl,s={block_id:e,data:t};return this.makePOSTRequest(o,s)}deleteColumn(e,t){let o=window.global.designer.deleteColumnUrl,s={block_id:t.block_id,id:t.id};return this.makePOSTRequest(o,s)}addNewAtomToColumn(e,t,o,s){let l=window.global.designer.addNewAtomToColumnUrl,i={block_id:e,col_id:t,index:o,data:s};return this.makePOSTRequest(l,i)}moveAtomInColumn(e,t,o,s){let l=window.global.designer.moveAtomInColumnUrl,i={block_id:e,col_id:t,new_index:o,old_index:s};return this.makePOSTRequest(l,i)}}class w extends r.a{deleteBlock(e){let t=window.global.designer.deleteBlockDataUrl,o={block_id:e};return this.makePOSTRequest(t,o)}saveBlockData(e,t){let o=window.global.designer.saveBlockDataUrl,s={block_id:e,data:t};return this.makePOSTRequest(o,s)}saveBlockDataFromPreset(e,t){let o=window.global.designer.saveBlockDataUrl,s={from_preset:1,block_id:e,data:t};return this.makePOSTRequest(o,s)}saveRowData(e,t){let o=window.global.designer.saveRowDataUrl,s={block_id:e,data:t};return this.makePOSTRequest(o,s)}}const b=new(s(145).a),k=new f,y=new c,v=new w;let C={},S={},E={};const M={deleteStoreCaches({commit:e}){e("deleteStoreCaches")},setPresetToBlock({dispatch:e,commit:t,getters:o},{block_id:s,preset:l}){let i=o.getBlockData(s);return y.getPreset(l.alias).then(async e=>(e.data.row=a.b.fillDataBlockByStructure(e.data.row,a.b.getStructureByType(a.a.row)),i&&i.childs.row.is_can_be_background_full_width&&(e.data.row.is_can_be_background_full_width=i.childs.row.is_can_be_background_full_width,e.data.row.is_can_be_background_full_width&&(e.data.row.background_fullwidth=!0)),a.b.prepareBlocksData(e.data)))},setIsDraggingNow({commit:e},t){e("setIsDraggingNow",t)},async setBlockData({commit:e},{block_id:t,childs:o}){e("deleteStoreCaches"),e("setBlockData",{block_id:t,childs:o}),await v.saveBlockData(t,o)},setBlockDataWithoutRequest({commit:e},{block_id:t,childs:o}){e("deleteStoreCaches"),e("setBlockData",{block_id:t,childs:o})},setBlockDataFromPreset:async({commit:e},{block_id:t,childs:o})=>(e("deleteStoreCaches"),o.no_commit||e("setBlockData",{block_id:t,childs:o}),v.saveBlockDataFromPreset(t,o)),async setRowData({commit:e,state:t,getters:o},s){e("deleteStoreCaches"),e("setRowData",s);let l=o.getBlockIdFromRowId(s.id);clearTimeout(E[s.id]),E[s.id]=setTimeout(()=>v.saveRowData(l,s),500)},setColumnData({commit:e,state:t,getters:o},s){e("deleteStoreCaches"),e("setColumnData",s);let l=o.getBlockIdFromColumnId(s.id);clearTimeout(S[s.id]),S[s.id]=setTimeout(()=>{k.saveColumnData(l,s)},500)},setAtomData({commit:e,state:t,getters:o},s){e("deleteStoreCaches"),e("setAtomData",s);let l=o.getBlockIdFromAtomId(s.id);clearTimeout(C[s.id]),C[s.id]=setTimeout(()=>{b.saveAtomData(l,s)},500)},setAtomAttributeDataWithoutRequest({commit:e,state:o,getters:s},l){l.attrs||console.error(t.lang("При сохранении аттрибута не указана секция attrs для атома ")+l.id),e("setAtomAttributeData",l)},setAtomAttributeData({commit:e,state:o,getters:s},l){l.attrs||console.error(t.lang("При сохранении аттрибута не указана секция attrs для атома ")+l.id),e("setAtomAttributeData",l);let i=s.getBlockIdFromAtomId(l.id),n=s.getAtomData(i,l.id);Object.keys(l.attrs).forEach(e=>{n.attrs[e].value=l.attrs[e]}),b.saveAtomData(i,n)},setPaddingTopBottomToBlockColumns({commit:e,getters:t},o){e("setPaddingTopBottomToBlockColumns",o)},setMarginBottomToBlock({commit:e,getters:t},o){e("setMarginBottomToBlock",o)},deleteAtom({commit:e,state:t,getters:o},s){e("deleteStoreCaches"),e("deleteAtom",s),b.deleteAtom(s.block_id,s)},deleteColumn({commit:e,state:t,getters:o},s){e("deleteStoreCaches"),e("deleteColumn",s),k.deleteColumn(s.block_id,s)},deleteBlock:({commit:e,state:t,getters:o},s)=>(e("deleteStoreCaches"),e("deleteBlock",s),e("deleteStoreCaches"),v.deleteBlock(s)),async addNewAtomToColumn({commit:e,state:t,getters:o},s){s.atom.name=s.atom.name.replace("{n}",s.atom.id),e("deleteStoreCaches"),e("addNewAtomToColumn",s),await k.addNewAtomToColumn(s.block_id,s.col_id,s.index,s.atom)},async moveAtomInColumn({commit:e,state:t,getters:o},s){e("deleteStoreCaches"),e("moveAtomInColumn",s),await k.moveAtomInColumn(s.block_id,s.col_id,s.new_index,s.old_index)}},D={getBlocks:e=>e.blocks,getBlockData:e=>t=>{if(!e.blocks.length)return!1;let o;return e.blockFindCache.hasOwnProperty(t)?o=e.blockFindCache[t]:(o=e.blocks.findIndex(e=>e.block_id==t),-1!=o&&(e.blockFindCache[t]=o)),-1!=o&&e.blocks[o]},getBlockIdFromRowId:e=>t=>{let o=0;return e.blocks.forEach(e=>{e.childs.row.id==t&&(o=e.block_id)}),o},getBlockIdFromColumnId:e=>t=>{let o=0;return e.blocks.forEach(e=>{e.childs.row&&e.childs.row.childs&&e.childs.row.childs.forEach(s=>{s.id==t&&(o=e.block_id)})}),o},getBlockIdFromAtomId:e=>t=>{let o=0;return e.blocks.forEach(e=>{e.childs.row&&e.childs.row.childs&&e.childs.row.childs.forEach(s=>{s.childs.forEach(s=>{s.id==t&&(o=e.block_id)})})}),o},getColumnIdFromAtomId:e=>t=>{let o=0;return e.blocks.forEach(e=>{e.childs.row&&e.childs.row.childs&&e.childs.row.childs.forEach(e=>{e.childs.forEach(s=>{s.id==t&&(o=e.id)})})}),o},getAtomData:(e,t)=>(o,s)=>{let l,i=t.getBlockData(o),n={},a=o+"_"+s;return e.atomFindCache[a]?(l=e.atomFindCache[a],n=i.childs.row.childs[l[0]].childs[l[1]]):i.childs.row.childs.forEach((t,o)=>{t.childs.forEach((t,l)=>{t.id==s&&(n=t,e.atomFindCache[a]=[o,l])})}),n},getColumnData:(e,t)=>(o,s)=>{let l,i=t.getBlockData(o),n={},a=o+"_"+s;return e.columnFindCache[a]?(l=e.columnFindCache[a],n=i.childs.row.childs[l[0]]):i.childs.row.childs.forEach((t,o)=>{t.id==s&&(n=t,e.columnFindCache[a]=[o])}),n},getRowData:(e,t)=>(e,o)=>{let s=t.getBlockData(e),l={};return"object"!=typeof s.childs||Array.isArray(s.childs)?Array.isArray(s.childs)&&s.childs.forEach(e=>{e.id==o&&(l=s.childs.row)}):l=s.childs.row,l},getIsDraggingNow:e=>e.isDraggingNow,getColumnFromRightHand:(e,t)=>(e,o)=>{let s=t.getBlockData(e),l=!1,i=!1;return s.childs.row.childs.forEach(e=>{l||(i||e.id!=o?i&&(l=e):i=!0)}),l},getColumns:(e,t)=>e=>t.getBlockData(e).childs.row.childs,getColumnCount:(e,t)=>e=>t.getBlockData(e).childs.row.childs.length},A={setBlockData(e,t){let o=!1;e.blocks.forEach((s,l)=>{let i=[];if(s.block_id==t.block_id)return i=JSON.parse(JSON.stringify(e.blocks)),i[l]=t,o=!0,e.blocks=i,!1}),o||e.blocks.push(t)},setIsDraggingNow(e,t){e.isDraggingNow=t},setRowData(e,t){e.blocks.forEach(e=>{e.childs.row.id==t.id&&(e.childs.row=t)})},setColumnData(e,t){e.blocks.forEach(e=>{e.childs.row&&e.childs.row.childs&&e.childs.row.childs.forEach(e=>{e.id==t.id&&(e=t)})})},setAtomData(e,t){e.blocks.forEach(e=>{e.childs.row&&e.childs.row.childs&&e.childs.row.childs.forEach(e=>{let o=!1,s=[];e.childs.forEach((l,i)=>{l.id==t.id&&(e.childs&&(s=JSON.parse(JSON.stringify(e.childs))),s[i]=t,o=!0)}),o&&(e.childs=s)})})},setAtomAttributeData(e,t){e.blocks.forEach(e=>{e.childs.row&&e.childs.row.childs&&e.childs.row.childs.forEach(e=>{e.childs&&e.childs.forEach((e,o)=>{e.id==t.id&&Object.keys(t.attrs).forEach(o=>{e.attrs[o].value=t.attrs[o]})})})})},setPaddingTopBottomToBlockColumns(e,t){e.blocks.forEach(e=>{e.block_id==t.block_id&&e.childs.row.childs.forEach((e,o)=>{e.css["--designer-column-padding-top"].value=t.top,e.css["--designer-column-padding-bottom"].value=t.bottom})})},setMarginBottomToBlock(e,t){e.blocks.forEach(e=>{e.block_id==t.block_id&&(e.childs.row.css["--designer-row-margin-bottom"].value=t.value)})},deleteStoreCaches:e=>{e.atomFindCache={},e.columnFindCache={},e.blockFindCache={}},addNewAtomToColumn(e,t){e.blocks.forEach(e=>{e.block_id==t.block_id&&e.childs.row.childs.forEach(e=>{if(e.id==t.col_id){let o=JSON.parse(JSON.stringify(e.childs));o.push(t.atom),o.move(o.length-1,t.index),e.childs=o}})})},moveAtomInColumn(e,t){e.blocks.forEach(e=>{e.block_id==t.block_id&&e.childs.row.childs.forEach(e=>{if(e.id==t.col_id)return e.childs.move(t.old_index,t.new_index),!0})})},deleteAtom(e,t){e.blocks.forEach(e=>{e.block_id==t.block_id&&e.childs.row.childs.forEach(e=>{e.childs.forEach((o,s)=>{if(o.id==t.id){let t=JSON.parse(JSON.stringify(e.childs));return t.splice(s,1),e.childs=t,!0}})})})},deleteColumn(e,t){e.blocks.forEach(e=>{if(e.block_id==t.block_id&&(!t.index&&t.id&&e.childs.row.childs.forEach((e,o)=>{e.id==t.id&&(t.index=o)}),e.childs.row.childs.splice(t.index,1),!e.childs.row.childs.length)){let t=!1;e.childs.row.css["max-width"]&&e.childs.row.css["max-width"].value&&(t=e.childs.row.css["max-width"].value),e.childs.row.css={},e.childs.row.attrs={};let o=a.b.getStructureByType(a.a.row);e.childs.row.css=o.css,e.childs.row.attrs=o.attrs,t&&(e.childs.row.css["max-width"].value=t)}})},deleteBlock(e,t){e.blocks.forEach((o,s)=>{o.block_id==t&&e.blocks.splice(s,1)})}};console.log("window['global']['designer']['blocks']",window.global.designer.blocks);const _={isDraggingNow:!1,blocks:a.b.prepareBlocksData(window.global.designer.blocks),blockFindCache:{},columnFindCache:{},atomFindCache:{}};s.d(o,"a",(function(){return O})),i.default.use(n.a),void 0===Array.prototype.move&&(Array.prototype.move=function(e,t,o=1){this.splice(t,0,...this.splice(e,o))}),void 0===String.prototype.replaceAll&&(String.prototype.replaceAll=function(e,t){return this.replace(new RegExp(e,"g"),t)});const O=new n.a.Store({modules:{blocks:{namespaced:!0,state:_,actions:M,getters:D,mutations:A},atoms:l},state:{selectedMenuTitle:lang.t("Панель инструменов"),menuStack:[]},getters:{getMenuStack:e=>e.menuStack,getSelectedMenuTitle:e=>e.selectedMenuTitle},mutations:{clearMenuStack(e){e.menuStack=[]},closeLastPanel:e=>new Promise((t,o)=>{e.menuStack.pop(),t()}),openMenu(e,t){e.menuStack.findIndex(e=>e.type==t.type);let o=e.menuStack;o.push(t),e.selectedMenuTitle=o[o.length-1].title}},actions:{openMenu({commit:e,getters:t},o){e("openMenu",o)},closeLastPanel({commit:e,dispatch:t,getters:o,state:s}){e("closeLastPanel"),sessionStorage.removeItem("atom-dbl-click");let l=s.menuStack;l.length&&(s.selectedMenuTitle=l[l.length-1].title)},clearMenuStack({commit:e}){e("clearMenuStack")}}})},363:function(e,t,o){"use strict";o.r(t);var s=o(6),l=o(33),i=o(7),n=o(1),a={data:()=>({isEmptyBlock:!1,row:null}),beforeMount(){this.dataId=this.$el.attributes["data-id"].value,this.isEmptyBlock=this.$el.classList.contains("d-empty")},mounted(){let e=this.getBlockData(this.dataId);e&&e.childs&&e.childs.row&&(this.row=e.childs.row),document.addEventListener("designer.block-update-all",this.updateBlock),"click"==this.$clickevent&&(document.addEventListener("keydown",this.setDragCopyCursor),window.addEventListener("keyup",this.checkCancelDrag))},beforeDestroy(){document.removeEventListener("designer.block-update-all",this.updateBlock),"click"==this.$clickevent&&(document.removeEventListener("keydown",this.setDragCopyCursor),document.removeEventListener("keyup",this.unsetDragCopyCursor),window.removeEventListener("keyup",this.checkCancelDrag))},methods:{getRowId(){return"d-row-"+this.dataId},getData(){return this.getRowData(this.dataId,this.row.id)},getAdditionalClass(){return this.getData().additional_class},setDragCopyCursor(e){e.ctrlKey&&(document.querySelector("body").classList.add("d-atom-sorting"),document.addEventListener("keyup",this.unsetDragCopyCursor))},checkCancelDrag(e){"Escape"==e.key&&(window.cancel_drag=1)},unsetDragCopyCursor(e){let t=document.querySelector("body");t.classList.contains("d-atom-sorting")&&t.classList.remove("d-atom-sorting")},getClassForDataRow(){let e=[];this.isNeedShowFullWidthClass()&&e.push("d-full-width");let t=this.getAdditionalClass();return t&&t.length&&e.push(t),e},append({added:e}){e.element.id=this.uuid(),e.element.name=e.element.name.replace("{n}",e.element.id);let t=n.b.getStructureByType(n.a.column);t.id=this.uuid(),t.name=t.name.replace("{n}",t.id),t.childs=[e.element];let o={},s=this.getBlockData(this.dataId);s?(o=s.childs,o.row.id||(o.row=n.b.getStructureByType(n.a.row),o.row.id=this.uuid()),o.row.childs=[t]):(o.row=n.b.getStructureByType(n.a.row),o.row.id=this.uuid(),o.row.childs=[t]),this.isEmptyBlock&&n.b.toggleModuleButtons(this.dataId.toString()),this.setBlockData({block_id:this.dataId.toString(),childs:o}),this.closeLastPanel()},updateBlock(e){e.detail.block_id==this.dataId&&(this.isEmptyBlock=!1)},colsData(){let e=this.getBlockData(this.dataId);return!!(e&&e.childs&&e.childs.row&&e.childs.row.childs&&e.childs.row.childs.length)&&(this.row=e.childs.row,e.childs.row.childs)},isNeedShowFullWidthClass(){return this.row.background_fullwidth},isNeedHideOnMobile(){return this.row.hidden.xs}},computed:{isNotEmpty(){let e=this.colsData();return!!e&&e.length>0},cols(){return this.colsData()},...Object(i.c)("blocks",["getRowData"])}},r={methods:{workStylesOfElement(e,t,o,s){let l=e.css[t],i=l.value;o=n.b.workStyleValueToCSSArray(i,t,o);let a=l.hover;if(a)if("object"==typeof a){let e=Object.keys(a)[0];e&&e.length&&(s=n.b.workStyleValueToCSSArray(a,t,s))}else a.length&&(s=n.b.workStyleValueToCSSArray(a,t,s));return{styles:o,hover_styles:s}},getClassesForAtom(e,t,o,s=""){let l=[],i=[];Object.keys(o.css).forEach(e=>{if(o.css_for_wrapper.length&&-1!=o.css_for_wrapper.indexOf(e))return;let t=this.workStylesOfElement(o,e,l,i);l=t.styles,i=t.hover_styles}),l=l.join(";\n\t");let n="";return n=s.length?s+" ."+o.attrs.class.value:".d-atom-"+this.dataId+"-"+o.id,t+="#"+e+" "+n+"{\n",t+="\t"+l,t+=";\n}\n",i.length&&(i=i.join(";\n"),t+="#"+e+" "+n+":hover{\n",t+="\t"+i,t+=";\n}\n"),t},getClassesForCol(e,t,o){let s=[],l=[];Object.keys(o.css).forEach(e=>{let t=this.workStylesOfElement(o,e,s,l);s=t.styles,l=t.hover_styles}),s=s.join(";\n\t"),s&&s.length&&(t+="#"+e+" .d-col-wrapper-"+o.id+"{\n",t+="\t"+s,t+=";\n}\n"),l&&l.length&&(l=l.join(";\n\t"),t+="#"+e+" .d-col-wrapper-"+o.id+":hover{\n",t+="\t"+l,t+=";\n}\n");let i=[];return Object.keys(o.css).forEach(e=>{"justify-content"==e&&i.push(e+": "+o.css[e].value)}),i.length&&(t+="#"+e+" .d-col-"+o.id+"{\n",t+="\t"+i.join(";")+";\n\t",t+="\n}\n"),t},getClassesForSubRow(e,t,o){let s=[],l=[];return Object.keys(o.css).forEach(e=>{if("max-width"==e){let t=this.workStylesOfElement(o,e,s,l);s=t.styles,l=t.hover_styles}}),s=s.join(";\n\t"),s&&s.length&&(t+="#"+e+" .d-row{\n",t+="\t"+s,t+=";\n}\n"),l&&l.length&&(l=l.join(";\n\t"),t+="#"+e+" .d-row:hover{\n",t+="\t"+l,t+=";\n}\n"),t},getClassesForRow(e,t,o){let s=[],l=[];return Object.keys(o.css).forEach(e=>{if("max-width"==e)return;let t=this.workStylesOfElement(o,e,s,l);s=t.styles,l=t.hover_styles}),s=s.join(";\n\t"),s&&s.length&&(t+="#"+e+"{\n",t+="\t"+s,t+=";\n}\n"),l&&l.length&&(l=l.join(";\n\t"),t+="#"+e+":hover{\n",t+="\t"+l,t+=";\n}\n"),t=this.getClassesForSubRow(e,t,o)}},computed:{rowStyles(){let e=this.getBlockData(this.dataId).childs.row,t="";if(e.childs&&e.childs.length){let o=this.getRowId();t=this.getClassesForRow(o,t,e),e.childs.forEach(e=>{t=this.getClassesForCol(o,t,e),e.childs&&e.childs.length&&e.childs.forEach(e=>{t=this.getClassesForAtom(o,t,e),e.childs&&Object.keys(e.childs).forEach(s=>{let l=e.childs[s],i=".d-atom-"+this.dataId+"-"+e.id;t=this.getClassesForAtom(o,t,l,i)})})})}return`<style type="text/css">${t}</style>`}}},c=o(147),d=o(100);n.b.checkProSubscribeBroken(),s.default.prototype.$clickevent=n.b.getClickOrTouchEvent(),s.default.prototype.$mouseup=n.b.getClickOrTouchEvent("mouseup"),s.default.prototype.$mousemove=n.b.getClickOrTouchEvent("mousemove");let h=document.querySelectorAll(".designer-block");h.length&&h.forEach(e=>{new s.default({el:e,mixins:[c.a,a,r,d.a],props:["dataId"],store:l.a,template:`\n                <div class="designer-block" :class="{'d-empty': isEmptyBlock}" :data-id="dataId">\n                    <draggable v-if="!isNotEmpty" :list="[]" group="atoms" :sort="false" @change="append" @start="dragstart" @end="dragend" class="designer-stub" :class="{ 'dragging-now': getIsDraggingNow}">\n                        <a class="open-designer create-designer-block" :data-block-id="dataId">${lang.t("Создать собственный блок")}</a>\n                    </draggable>\n                    <template v-else>\n                        <div v-html="rowStyles"></div>\n                        <div :id="getRowId()" class="d-row-wrapper" :class="{ 'd-full-width': isNeedShowFullWidthClass(), 'd-hidden-col-xs' : isNeedHideOnMobile() }" :data-id="dataId">\n                            <div :class="getClass"> \n                                <template v-for="(col, index) in cols">\n                                    <Column :block-id="dataId" :col="col" :colIndex="index"></Column>\n                                </template>\n                            </div>\n                            <RowMarginZone :block-id="dataId"></RowMarginZone>\n                            <RowPaddingZone :block-id="dataId"></RowPaddingZone>\n                        </div>\n                        <div class="d-pillow"></div>\n                    </template>\n                </div>\n            `,components:{Column:()=>o.e(6).then(o.bind(null,400)),RowPaddingZone:()=>o.e(26).then(o.bind(null,401)),RowMarginZone:()=>o.e(25).then(o.bind(null,402))}})})},364:function(e,t,o){"use strict";o.r(t);var s=o(6),l=o(7),i=o(33),n=o(1),a={methods:{workStylesOfElement(e,t,o,s){let l=e.css[t],i=l.value;o=n.b.workStyleValueToCSSArray(i,t,o);let a=l.hover;if(a)if("object"==typeof a){let e=Object.keys(a)[0];e&&e.length&&(s=n.b.workStyleValueToCSSArray(a,t,s))}else a.length&&(s=n.b.workStyleValueToCSSArray(a,t,s));return{styles:o,hover_styles:s}},getClassesForAtom(e,t,o=""){let s=[],l=[];Object.keys(t.css).forEach(e=>{let o=this.workStylesOfElement(t,e,s,l);s=o.styles,l=o.hover_styles}),s=s.join(";\n\t");let i="";if(o.length){let e=t.attrs.class.value;i="d-mobile-mmenu-fog"==e||-1!=e.indexOf("::-webkit-")?"."+e:"body ."+o+" ."+e}else{i="body ."+t.attrs.class.value}return e+=i+"{\n",e+="\t"+s,e+=";\n}\n",l.length&&(l=l.join(";\n"),e+=i+":hover{\n",e+="\t"+l,e+=";\n}\n"),e}},computed:{rowStyles(){let e=this.getBlockData(this.dataId).childs.row,t="";return e.childs&&e.childs.length&&e.childs.forEach(e=>{e.childs&&e.childs.length&&e.childs.forEach(e=>{t=this.getClassesForAtom(t,e),e.childs&&Object.keys(e.childs).forEach(o=>{let s=e.childs[o],l=e.attrs.class.value;t=this.getClassesForAtom(t,s,l)})})}),`<style type="text/css">${t}</style>`}}};new s.default({el:"#designers-block-settings",mixins:[a],store:i.a,template:'\n        <div id="designers-block-settings">\n            <div v-html="rowStyles"></div>\n            <AtomMMenu :block-id="dataId" :item-id="\'mobilemenu\'"></AtomMMenu>\n        </div>\n    ',data:()=>({dataId:"settings"}),components:{AtomMMenu:()=>o.e(20).then(o.bind(null,448))},computed:{...Object(l.c)("blocks",["getBlockData"])}})},51:function(e,t,o){"use strict";o.d(t,"a",(function(){return i}));var s=o(6);let l={action:{text:lang.t(""),icon:"",class:"d-toast-close",onClick:(e,t)=>{t.goAway(0)}},theme:"toasted-primary",position:"bottom-right",singleton:!0,duration:5e4};class i{static clear(){s.default.toasted.clear()}static showSimpleMessage(e){l.type=null,s.default.toasted.show(e,l)}static showError(e){l.type="error",s.default.toasted.show(e,l)}static showMessage(e){let t=e.text,o=e.options;o&&"error"==o.theme?i.showError(t):i.showSimpleMessage(t)}}},99:function(e,t,o){"use strict";var s=o(7);t.a={methods:{getColClassBySize:e=>"d-col-md-"+e,checkDeleteAtom(e){if("Delete"==e.key&&!e.target.closest("input")&&!e.target.closest("textarea")&&!e.target.closest("[content-editable]")){let e=document.querySelector(".d-atom.hover");if(e){let t=e.id.split("-"),o=t.pop(),s=t.pop(),l=this.getColumnIdFromAtomId(o);this.deleteAtom({block_id:s,id:o}),this.deleteStoreCaches(),this.changeColumnsWidthsIfNeeded(s,l),this.body.removeEventListener("keyup",this.checkDeleteAtom),this.enableEditModeModules()}}},changeColumnsWidthsIfNeeded(e,t){let o=this.getColumnData(e,t);if(!o.childs.length){this.deleteColumn({id:o.id,block_id:e});let t=this.getBlockData(e),s=JSON.parse(JSON.stringify(t.childs.row.childs));s.length&&this.saveColumnsWithWidth(t,this.changeColWidthAfterAppend(s),e)}},changeColWidthAfterAppend(e){let t,o=e.length;if(12%o==0)t=12/o,e.forEach(e=>{e.attrs.class.value=this.getColClassBySize(t)});else{t=5==o?2:o>6?1:2;let s=0;e.forEach((o,l)=>{if(l!=e.length-1)s+=t,o.attrs.class.value=this.getColClassBySize(t);else{let e=12-s;o.attrs.class.value=this.getColClassBySize(e)}})}return e},saveColumnsWithWidth(e,t,o){this.deleteStoreCaches(),e.childs.row.childs=t,this.setBlockData({block_id:o,childs:e.childs}),this.deleteStoreCaches()},...Object(s.b)("blocks",["deleteStoreCaches","deleteColumn","deleteAtom","setBlockData"])},computed:{...Object(s.c)("blocks",["getColumnIdFromAtomId","getColumnData","getAtomData","getBlockData"])}}}});