(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{366:function(t,e,s){"use strict";var i=s(7),o=s(156);s(1);e.a={data:()=>({body:null}),mounted(){this.body=document.querySelector("body")},methods:{getData(){return this.getAtomData(this.blockId,this.itemId)},getAttrs(){return this.getData().attrs},getAttrValue(t){let e=this.getAttrs()[t];try{return e||console.error(lang.t(`Не найден аттрибут "${t}" для атома c id ${this.itemId} в блоке ${this.blockId}`)),e.value}catch(s){console.info("name",t),console.info("attr",e),console.error(s)}},getCSSValue(t){return this.getData().css[t].value},getAdditionalClass(){return this.getData().additional_class},getAtomClass(){let t=this.getAdditionalClass();return this.getAtomIdByBlockId()+(t?" "+t:"")},getHiddenClasses(){let t=this.getData().hidden,e=[];return Object.keys(t).forEach(s=>{t[s]&&e.push("d-hidden-"+s)}),e},getAtomIdByBlockId(){return"d-atom-"+this.blockId+"-"+this.itemId},getAtomTagId(){return"d-atom-tag-"+this.itemId},getAtomChildren(){return this.getData().childs},openAtomParams(){let t=setTimeout(()=>{if(clearTimeout(t),sessionStorage.getItem("atom-dbl-click"))return;let e=this.getMenuStack;if(e.length){let t=e[e.length-1];if("atom"==t.data.type&&t.data.blockId==this.blockId&&t.data.id==this.itemId)return}o.designerLeftMenu.openMenuForAtom({blockId:this.blockId,id:this.itemId,type:"atom"})},250);setTimeout(()=>{this.setOpenHover()},50)},setOpenHover(){document.querySelectorAll(".d-atom.hover").forEach(t=>{t.classList.remove("hover")}),this.$refs.thisAtom.classList.add("hover")},contentForTiny(){let t=this.getData(),e=t.html,s=t.tag,i=this.getStyle,o=[],a=[];Object.keys(i).forEach(t=>{"padding-top"==t||"padding-bottom"==t?a.push(t+":"+i[t]):o.push(t+":"+i[t])});let d=this.getClass;return`<div style="${a.join(";")}"><${s} id="${this.getAtomTagId()}" class="${d} ${this.getAtomIdByBlockId()}" style="${o.join(";")}">${e}</${s}></div>`},removeFlagDoubleClick(){sessionStorage.removeItem("atom-dbl-click")},setFlagDoubleClick(){sessionStorage.setItem("atom-dbl-click",1)},setCSSParamValue(t,e){let s=this.getData();s.css[t].value=e,this.setAtomData(s)},addRowEditClass(){this.body.classList.add("d-row-edit")},removeRowEditClass(){this.body.classList.remove("d-row-edit")},disableEditModeModules(){let t=this.body.querySelectorAll(".module-wrapper");t&&t.forEach(t=>{t.classList.add("disabled")}),this.$el.closest(".module-wrapper").classList.remove("disabled")},enableEditModeModules(){let t=document.querySelector("body").querySelectorAll(".module-wrapper");t&&t.forEach(t=>{t.classList.remove("disabled")})},setColumnDraggable(t){let e=new CustomEvent("atom-image-set-column-draggable",{detail:{enabled:t}});document.dispatchEvent(e)},setRedrawAtomListener(t){document.addEventListener("designer.redraw-atom."+this.itemId,t)},removeRedrawAtomListener(t){document.removeEventListener("designer.redraw-atom."+this.itemId,t)},...Object(i.b)(["closeLastPanel"]),...Object(i.b)("blocks",["setAtomData"])},computed:{getHtml(){return this.getData().html},content(){let t=this.getData(),e=t.html,s=t.tag;return`<${s} class="${this.getAtomIdByBlockId()}">${e}</${s}>`},contentWithoutClass(){let t=this.getData(),e=t.html,s=t.tag,i="";return this.getSpecialStyles&&(i="style='"+this.getSpecialStyles()+"'"),`<${s} ${i}>${e}</${s}>`},...Object(i.c)("blocks",["getAtomData"]),...Object(i.c)(["getMenuStack"])}}},367:function(t,e,s){"use strict";e.a={mounted(){this.load_js&&this.load_js.forEach(this.loadExternalJS),this.load_css&&this.load_css.forEach(this.loadExternalCSS)},methods:{loadExternalJS(t){let e=t.split("/").pop().replace(".","_");if(!window[e+"_loaded"]){let s=document.createElement("script");s.type="text/javascript",s.src=t,document.body.appendChild(s),window[e+"_loaded"]=1}},loadExternalCSS(t){let e=t.split("/").pop().replace(".","_");window[e+"_loaded"]||(this.body||(this.body=document.querySelector("body")),this.body.insertAdjacentHTML("beforeend",`\n                   <link href="${t}" type="text/css" rel="stylesheet"/>\n               `))}}}},413:function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{class:t.getHiddenClasses()},[s("AtomMarginZone",{attrs:{"block-id":t.blockId,"item-id":t.itemId},on:t._d({},[t.$clickevent,function(t){t.preventDefault(),t.stopPropagation()}])}),t._v(" "),s("div",{ref:"wrapper",staticClass:"d-atom-html-wrapper"},[s("div",{ref:"thisAtom",staticClass:"d-atom d-atom-html",attrs:{id:t.getAtomIdByBlockId()},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.clickChooseModeToEnable(e)}}},[s("div",{staticClass:"d-atom-html-zone",style:t.getWidthAlignData()},[s("div",{staticClass:"d-atom-instance d-atom-item"},[t.editHtmlMode?[s("div",{on:t._d({},[t.$clickevent,function(t){t.preventDefault(),t.stopPropagation()}])},[s("div",{staticClass:"code-editor",style:{height:"400px","margin-top":t.getCSSValue("margin-top")},attrs:{id:"code_editor"}},[s("textarea",{ref:"textarea",staticClass:"d-html-textarea",staticStyle:{height:"400px"},domProps:{textContent:t._s(t.getHtml)}})]),t._v(" "),s("div",{staticClass:"d-atom-html-buttons"},[t.editorIsInited()?s("div",{staticClass:"d-atom-none-select"},[s("a",{staticClass:"d-green-button",on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.onSaveHtml(e)}}},[t._v(t._s(t.lang("Сохранить")))])]):t._e()])])]:[s("WidthResize",{attrs:{"block-id":t.blockId,"item-id":t.itemId}}),t._v(" "),s("div",{ref:"text",staticClass:"d-atom-item",class:t.getAtomClass(),domProps:{innerHTML:t._s(t.getHtml)}})]],2)])])])],1)};i._withStripped=!0;var o=s(366),a=s(1),d={data:()=>({editHtmlMode:!1,editor:null,touchTime:0,load_js:[window.global.designer.ace_js_url]}),methods:{clickChooseModeToEnable(t){0==this.touchTime?(this.openAtom(),this.editHtmlMode=!1,this.touchTime=(new Date).getTime()):(new Date).getTime()-this.touchTime<800?(this.toggleEditHtml(),this.editHtmlMode=!0,setTimeout(()=>{a.b.closeAllPanels()},250),this.touchTime=0):(this.editHtmlMode=!1,this.touchTime=(new Date).getTime(),this.openAtom())},toggleEditHtml(){this.editHtmlMode=!this.editHtmlMode},getWidthAlignData(){let t=this.getData();return{width:t.css["max-width"].value?t.css["max-width"].value:"100%","align-self":t.css["align-self"].value}},openAtom(){this.editHtmlMode||this.openAtomParams()},editorIsInited(){return setTimeout(()=>{window.define=ace.define,this.editor=ace.edit(this.$refs.textarea),this.editor.setOptions({autoScrollEditorIntoView:!0,minLines:30}),this.editor.getSession().setUseWorker(!1),this.editor.getSession().setMode("ace/mode/html"),this.editor.getSession().setValue(this.getHtml),this.editor.resize()},200),!0},onSaveHtml(t){let e=this.getData();e.html=this.editor.getSession().getValue(),this.editor.destroy(),this.editor=null,document.querySelector(".ace_editor",this.$refs.wrapper).remove(),this.setAtomData(e),this.toggleEditHtml()}},computed:{getHtml(){return this.getData().html}}},l=s(100),r=s(99),n=s(367),c={name:"AtomHtml",mixins:[o.a,r.a,l.a,n.a,d],props:{itemId:{type:String,required:!0},colIndex:{type:Number,required:!0},blockId:{type:String,required:!0}},components:{AtomMarginZone:()=>s.e(21).then(s.bind(null,421)),WidthResize:()=>s.e(74).then(s.bind(null,422))}},m=s(98),h=Object(m.a)(c,i,[],!1,null,null,null);h.options.__file="-readyscript/modules/designer/view/js/app/src/components/designerblock/atoms/html/html.vue";e.default=h.exports}}]);