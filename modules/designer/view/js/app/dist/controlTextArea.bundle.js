(window.webpackJsonp=window.webpackJsonp||[]).push([[58,68],{365:function(e,t,n){"use strict";var i=n(7),o=n(1);t.a={data:()=>({tinymceOptions:{height:200,theme:"modern",plugins:["link image lists anchor","searchreplace wordcount visualblocks visualchars code fullscreen media","save table contextmenu paste textcolor"],menubar:"file edit view",toolbar:"insertfile undo redo | styleselect | bold italic underline | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image | print preview media fullpage | forecolor backcolor emoticons",language:"ru"},tinymceInlineOptions:{toolbar_items_size:"small",language:"ru",menubar:!1,inline:!0,plugins:"link textcolor",toolbar:"bold italic underline strikethrough",valid_elements:"*",valid_styles:{"*":"font-size,font-family,color,text-decoration,text-align"},extended_valid_elements:"*[*]",cleanup:!1,verify_html:!1,powerpaste_word_import:"clean",powerpaste_html_import:"clean",content_css:[]}}),methods:{getItemValue(e,t,n=null){let i=this.getItem();if(n){if(i.childs[n][e]&&i.childs[n][e][t])return i.childs[n][e][t].value;console.error(lang.t(`No property "${t}" in SUB CHILD item[${e}]`),i.childs[n][e])}else{if(i[e]&&i[e][t])return i[e][t].value;console.error(lang.t(`No property "${t}" in item[${e}]`),i[e])}return""},getItem(){switch(this.itemType){case o.a.atom:return this.getAtomData(this.blockId,this.itemId);case o.a.column:return this.getColumnData(this.blockId,this.itemId);case o.a.row:return this.getRowData(this.blockId,this.itemId);default:throw new Error(lang.t("Нет метода для получения данных. Тип: %0",[this.itemType]))}},getItemOptions(){return this.getItem()[this.keyName][this.item.name].data.options},setItemData(e){switch(this.itemType){case o.a.atom:this.setAtomData(e);break;case o.a.column:this.setColumnData(e);break;case o.a.row:this.setRowData(e);break;default:throw new Error(lang.t("Нет метода для получения данных. Тип: %0",[this.itemType]))}},setAtomKeyValue(e){let t=this.getItem();t[this.item.name]=e,this.setItemData(t);let n=new CustomEvent("designer.redraw-atom."+t.id,{detail:{id:t.id,value:e}});document.dispatchEvent(n),setTimeout(()=>{this.checkIfNeedSendEventAfterEdit(t)},500)},addStyleIfNeeded(e,t){"css"==this.keyName&&("background-image"==e&&t.trim().length&&(t="url('"+t+"')"),this.addStyleParameter(e,t))},checkIfNeedSendEventAfterEdit(e){if(e[this.keyName][this.item.name].debug_event){let t=new CustomEvent(e[this.keyName][this.item.name].debug_event,{detail:{id:this.itemId}});document.dispatchEvent(t)}},sendDataValueFromEvent(e){let t=e.target.value;"background-image"==this.item.name&&(t=t.replaceAll(" ","%20"));let n=this.getItem();"css"==this.keyName&&this.itemChildId?n.childs[this.itemChildId][this.keyName][this.item.name].value=t:(n[this.keyName][this.item.name].value=t,this.checkIfNeedSendEventAfterEdit(n)),this.setItemData(n)},sendDataValue(e){let t=this.getItem();"background-image"==this.item.name&&(e=e.replaceAll(" ","%20")),"css"==this.keyName&&this.itemChildId?t.childs[this.itemChildId][this.keyName][this.item.name].value=e:(t[this.keyName][this.item.name].value=e,this.checkIfNeedSendEventAfterEdit(t)),this.setItemData(t)},clear(){this.sendDataValue(""),this.isHoverable&&this.sendDataHoverValue("")},getStyleLikeObject(){let e=this.getItem();return o.b.convertInlineStyleToObject(e.attrs.style.value)},addStyleParameter(e,t){let n=this.getStyleLikeObject();"string"==typeof t?0==(t=t.trim()).length?delete n[e]:n[e]=t:"object"==typeof t&&(n[e]=t);let i=this.getItem();i.attrs.style.value=o.b.convertStyleObjectToString(n),this.setItemData(i)},...Object(i.b)("blocks",["setAtomData","setRowData","setColumnData"])},computed:{itemValue(){return this.getItemValue(this.keyName,this.item.name,this.itemChildId)},itemHoverValue(){return this.getItemHoverValue(this.keyName,this.item.name,this.itemChildId)},...Object(i.c)("blocks",["getAtomData","getColumnData","getRowData"])}}},380:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return o}));var i=function(){return"undefined"!=typeof window?window:e},o=function(){var e=i();return e&&e.tinymce?e.tinymce:null}}).call(this,n(34))},385:function(e,t,n){"use strict";n.r(t);var i=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],o=function(e){return-1!==i.indexOf(e)},a=function(e,t,n){var i=t.$props.value?t.$props.value:"",a=t.$props.initialValue?t.$props.initialValue:"";n.setContent(i||a),t.$listeners.input&&function(e,t){var n,i=e.$props.modelEvents?e.$props.modelEvents:null,o=Array.isArray(i)?i.join(" "):i;e.$watch("value",(function(e,i){t&&"string"==typeof e&&e!==n&&e!==i&&(t.setContent(e),n=e)})),t.on(o||"change keyup undo redo",(function(){n=t.getContent(),e.$emit("input",n)}))}(t,n),function(e,t,n){Object.keys(t).filter(o).forEach((function(i){var o=t[i];"function"==typeof o&&("onInit"===i?o(e,n):n.on(i.substring(2),(function(e){return o(e,n)})))}))}(e,t.$listeners,n)},r=0,s=function(e){var t=Date.now();return e+"_"+Math.floor(1e9*Math.random())+ ++r+String(t)},l=function(e){return void 0===e||""===e?[]:Array.isArray(e)?e:e.split(" ")},u=n(380),c={apiKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],value:String,disabled:Boolean},d=function(){return(d=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},m={listeners:[],scriptId:s("tiny-script"),scriptLoaded:!1},h=function(e){return function(){var t,n,i,o=d({},e.$props.init,{readonly:e.$props.disabled,selector:"#"+e.elementId,plugins:(t=e.$props.init&&e.$props.init.plugins,n=e.$props.plugins,l(t).concat(l(n))),toolbar:e.$props.toolbar||e.$props.init&&e.$props.init.toolbar,inline:e.inlineEditor,setup:function(t){e.editor=t,t.on("init",(function(n){return a(n,e,t)})),e.$props.init&&"function"==typeof e.$props.init.setup&&e.$props.init.setup(t)}});null!==(i=e.element)&&"textarea"===i.tagName.toLowerCase()&&(e.element.style.visibility=""),Object(u.a)().init(o)}},p={props:c,created:function(){this.elementId=this.$props.id||s("tiny-vue"),this.inlineEditor=this.$props.init&&this.$props.init.inline||this.$props.inline},watch:{disabled:function(){this.editor.setMode(this.disabled?"readonly":"design")}},mounted:function(){if(this.element=this.$el,null!==Object(u.a)())h(this)();else if(this.element&&this.element.ownerDocument){var e=this.element.ownerDocument,t=this.$props.cloudChannel?this.$props.cloudChannel:"5",n=this.$props.apiKey?this.$props.apiKey:"no-api-key";!function(e,t,n,i){e.scriptLoaded?i():(e.listeners.push(i),t.getElementById(e.scriptId)||function(e,t,n,i){var o=t.createElement("script");o.referrerPolicy="origin",o.type="application/javascript",o.id=e,o.addEventListener("load",i),o.src=n,t.head&&t.head.appendChild(o)}(e.scriptId,t,n,(function(){e.listeners.forEach((function(e){return e()})),e.scriptLoaded=!0})))}(m,e,"https://cdn.tiny.cloud/1/"+n+"/tinymce/"+t+"/tinymce.min.js",h(this))}},beforeDestroy:function(){null!==Object(u.a)()&&Object(u.a)().remove(this.editor)},render:function(e){return this.inlineEditor?function(e,t,n){return e(n||"div",{attrs:{id:t}})}(e,this.elementId,this.$props.tagName):function(e,t){return e("textarea",{attrs:{id:t},style:{visibility:"hidden"}})}(e,this.elementId)}};t.default=p},429:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",["textarea"==e.type?n("div",{staticClass:"d-menu-textarea"},[n("textarea",{ref:"textarea",on:{input:e.sendDataValueFromEvent}},[e._v(e._s(e.itemValue))])]):"textareastyle"==e.type?n("div",{staticClass:"d-menu-textarea"},[n("textarea",{ref:"textarea",on:{input:e.sendDataValueFromEvent}},[e._v(e._s(e.formatStyle(e.itemValue)))])]):n("div",{staticClass:"d-menu-textarea"},[e.setTinyValue()?[n("tinymce",{ref:"tinymce",staticClass:"d-tinymce",attrs:{init:e.tinymceOptions},on:{input:function(t){return e.onChange()}},model:{value:e.html,callback:function(t){e.html=t},expression:"html"}})]:e._e()],2)])};i._withStripped=!0;var o=n(365),a={data:()=>({changeTinyMceTimeout:null,html:""}),methods:{setTinyValue:function(){return this.html=this.itemValue.toString(),!0},onChange(){this.changeTinyMceTimeout=setTimeout(()=>{clearTimeout(this.changeTinyMceTimeout),this.sendDataValue(this.html)},100)},formatStyle:e=>e.replace(/\n/g,"").replace(/(;)/g,"$1\n")}},r=n(385),s={name:"ControlTextArea",mixins:[o.a,a],props:{keyName:{type:String,required:!0},type:{type:String,required:!0},blockId:{type:[String,Number],required:!0},itemType:{type:String,required:!0},itemId:{type:String,required:!0},item:{type:Object,required:!0},itemChildId:{type:[String,Number]}},components:{tinymce:r.default}},l=n(98),u=Object(l.a)(s,i,[],!1,null,null,null);u.options.__file="-readyscript/modules/designer/view/js/app/src/components/leftpanel/controls/textarea/textarea.vue";t.default=u.exports}}]);